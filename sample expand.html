<html><head><style>

	body {
		background-color: black;
	}

	.image {
		border: 2px solid white;
		margin: 2px;
		width: calc(33.33% - 5px);
	}

	.video-container {
		margin: 2px;
		width: calc(33.33% - 9px);
		position: relative;
	    display: inline-block;
	}

	.video {
		border: 2px solid white;
	    width: 100%;
	    height: auto;
	}

	.play-icon {
	    position: absolute;
	    top: 50%;
	    left: 50%;
	    transform: translate(-50%, -50%);
	    font-size: 2em;
	    color: white;
	    pointer-events: none;
	    display: block;
	}

	.video-container:hover .play-icon {
	    display: none;
	}

	#speakerIcon {
		  cursor: pointer;
	}

	.selected {
		border: 2px solid red;
	}

	#fixedContainer {
		position: fixed;
		top: 0;
		width: 100%;
		background-color: white;
		opacity: 0.3;
		transition: opacity 0.3s;
		z-index: 100;
		display: flex;
	    align-items: center;
	    justify-content: left;
	    padding: 10px;
	}

	#fixedContainer:hover {
		opacity: 1;
	}

	#fixedContainer * {
	    margin-right: 10px;
	}

	#selectedImages {
		width: 400px;
		height: 30px;
		white-space: pre;
		overflow: auto;
		margin-bottom: 5px;
		margin-top: 15px;
	}

	.imagesContainer {
		width: 80%;
    	margin: auto;
	}

	#shortcutGuide {
	    direction: rtl;
	}

	.modal {
	  display: none;
	  position: fixed;
	  z-index: 1;
	  left: 0;
	  top: 0;
	  width: 100%;
	  height: 100%;
	  overflow: auto;
	  background-color: rgba(0,0,0,0.9);
	}

	.modal-content {
	  margin: auto;
	  display: block;
	  width: auto; 
	  max-width: 100%;
	  padding-top: 3%;
	}

	#modalCaption {
	    color: white;
	    text-align: center;
	    padding: 10px;
	}


</style><script>

	var selectedImages = [];
	var keysPressed = {};

	// Change the background color of the body
	function changeBackgroundColor(color) {
	    document.body.style.backgroundColor = color;
	}

	// Update the width of the container that holds images and videos
	function updateContainerWidth() {
	    var containerWidth = document.getElementById('containerWidthRange').value;
	    document.getElementsByClassName('imagesContainer')[0].style.width = containerWidth + '%';
	}

	// Update the display of images and videos based on the selected range
	function updateImages() {
		var numberOfImages = document.getElementById('imageRange').value;
		var percentWidth = 100 / numberOfImages - 0.5;
		var images = document.querySelectorAll('.image, .video-container');
		for(var i = 0; i < images.length; i++) {
			images[i].style.width = 'calc(' + percentWidth + '% - 4px)';
		}
		document.getElementById('rangeValue').textContent = numberOfImages;
	}

	// Update the display of selected images and videos
	function updateSelectedImagesDisplay() {
		document.getElementById('selectedImages').value = selectedImages.join('\n');
	}

	// Toggle selection of an image or video
	function toggleSelection(media) {
		var imageName = media.getAttribute('src');
		var index = selectedImages.indexOf(imageName);
		if(index > -1) {
			selectedImages.splice(index, 1);
			media.classList.remove('selected');
		} else {
			selectedImages.push(imageName);
			media.classList.add('selected');
		}
		updateSelectedImagesDisplay();
	}

	// Select all images and videos
	function selectAllImages() {
		var images = document.querySelectorAll('.image, .video');
		selectedImages = [];
		for(var i = 0; i < images.length; i++) {
			var imageName = images[i].getAttribute('src');
			selectedImages.push(imageName);
			images[i].classList.add('selected');
		}
		updateSelectedImagesDisplay();
	}

	// Reverse the selection of images and videos
	function reverseSelections() {
		var images = document.querySelectorAll('.image, .video');
		selectedImages = [];
		for(var i = 0; i < images.length; i++) {
			var imageName = images[i].getAttribute('src');
			if(images[i].classList.contains('selected')) {
				images[i].classList.remove('selected');
			} else {
				selectedImages.push(imageName);
				images[i].classList.add('selected');
			}
		}
		updateSelectedImagesDisplay();
	}

	// Download selected images and videos as a text file
	function downloadSelectedImages() {
		var text = document.getElementById('selectedImages').value;
		var blob = new Blob([text], {
			type: 'text/plain'
		});
		var a = document.createElement('a');
		a.download = '___del.txt';
		a.href = window.URL.createObjectURL(blob);
		a.style.display = 'none';
		document.body.appendChild(a);
		a.click();
		document.body.removeChild(a);
	}

	// Initialize the page and set up event listeners
	window.onload = function() {
		// Create the main slider container
		var sliderContainer = document.createElement('div');
		sliderContainer.id = 'fixedContainer';

		// Create and configure the image range slider
		var slider = document.createElement('input');
		slider.type = 'range';
		slider.id = 'imageRange';
		slider.min = '1';
		slider.max = '10';
		slider.value = '4';
		slider.oninput = function() {
			updateImages();
			this.blur();
		};

		// Create a span to display the range value
		var sliderValue = document.createElement('span');
		sliderValue.id = 'rangeValue';

		// Create and configure the container width slider
		var containerWidthSlider = document.createElement('input');
	    containerWidthSlider.type = 'range';
	    containerWidthSlider.id = 'containerWidthRange';
	    containerWidthSlider.min = '30';
	    containerWidthSlider.max = '100';
	    containerWidthSlider.value = '80'; // Default value
	    containerWidthSlider.oninput = updateContainerWidth;

	    // Creating color squares for background change
	    var blackSquare = document.createElement('div');
	    blackSquare.style.width = '20px';
	    blackSquare.style.height = '20px';
	    blackSquare.style.backgroundColor = 'black';
	    blackSquare.onclick = function() { changeBackgroundColor('black'); };
	    var whiteSquare = document.createElement('div');
	    whiteSquare.style.width = '20px';
	    whiteSquare.style.height = '20px';
	    whiteSquare.style.backgroundColor = 'white';
	    whiteSquare.style.border = '1px solid black';
	    whiteSquare.onclick = function() { changeBackgroundColor('white'); };

	    // Create buttons for selection actions
	    var revertButton = document.createElement('button');
	    revertButton.textContent = 'Revert Selection';
	    revertButton.onclick = reverseSelections;
	    var selectAllButton = document.createElement('button');
	    selectAllButton.textContent = 'Select All';
	    selectAllButton.onclick = selectAllImages;
	    var downloadButton = document.createElement('button');
	    downloadButton.textContent = 'Download Selected Files';
	    downloadButton.style.backgroundColor = 'red';
	    downloadButton.onclick = downloadSelectedImages;

		// Create a textarea for displaying selected images
		var selectedImagesDiv = document.createElement('textarea');
		selectedImagesDiv.id = 'selectedImages';
		selectedImagesDiv.readOnly = true;


		// Append elements to the fixed container
		sliderContainer.appendChild(slider);
		sliderContainer.appendChild(sliderValue);
		document.body.insertBefore(sliderContainer, document.body.firstChild);
		document.body.insertBefore(selectedImagesDiv, sliderContainer.nextSibling);
	    //var sliderContainer = document.getElementById('fixedContainer');
	    sliderContainer.appendChild(containerWidthSlider);
	    sliderContainer.appendChild(blackSquare);
	    sliderContainer.appendChild(whiteSquare);
	    sliderContainer.appendChild(revertButton);
	    sliderContainer.appendChild(selectAllButton);
	    sliderContainer.appendChild(downloadButton);


	    // Add click event listeners to images and videos to toggle selection
		var medias = document.querySelectorAll('.image, .video');
		for(var i = 0; i < medias.length; i++) {
			medias[i].addEventListener('click', function(event) {
				if (!event.shiftKey) {
					toggleSelection(this);
				}
			});
		}


	    // Create a keyboard shortcut guide
	    var shortcutGuide = document.createElement('div');
	    shortcutGuide.id = 'shortcutGuide';
	    shortcutGuide.textContent = 'Shortcuts: Press SHIFT+Click (Open Modal), R+V (Revert Selection), CMD+A (Select All), D+L (Download Selected)';
	    document.body.insertBefore(shortcutGuide, document.body.firstChild);

	    // Speaker icon for muting videos
	    var fixedContainer = document.getElementById('fixedContainer');
	    var speakerIcon = document.createElement('div');
	    speakerIcon.id = 'speakerIcon';
	    speakerIcon.textContent = 'ðŸ”Š';
	    fixedContainer.appendChild(speakerIcon);

	    var isMuted = false;

	    speakerIcon.addEventListener('click', function() {
	        isMuted = !isMuted;
	        speakerIcon.textContent = isMuted ? 'ðŸ”‡' : 'ðŸ”Š';

	        var videos = document.getElementsByTagName('video');
	        for (var i = 0; i < videos.length; i++) {
	            videos[i].muted = isMuted;
	        }
	    });

	    // Setup modal for image and video preview
	    var modal = document.getElementById('imageModal');
	    var modalImage = document.getElementById('modalImage');
	    var modalVideo = document.getElementById('modalVideo');
		var modalCaption = document.getElementById('modalCaption');

		// Add event listeners to images for modal
		var images = document.getElementsByClassName('image');
	    for (var i = 0; i < images.length; i++) {
	        images[i].addEventListener('click', function(event) {
	            if (event.shiftKey) {
	                modal.style.display = "block";
	                modalImage.src = this.src;
	                modalImage.style.display = "block";
	                modalVideo.style.display = "none";
	                modalCaption.textContent = this.src.split('/').pop();
	            }
	        });
	    }

    	// Add event listeners to videos for modal and hover play/pause
	    var videos = document.getElementsByClassName('video');
	    for (var j = 0; j < videos.length; j++) {
	        videos[j].addEventListener('mouseenter', function() {
	            this.play();
	        });
	        videos[j].addEventListener('mouseleave', function() {
	            this.pause();
	        });

	        videos[j].addEventListener('click', function(event) {
	            if (event.shiftKey) {
	                modal.style.display = "block";
	                modalVideo.src = this.src;
	                modalVideo.style.display = "block";
	                modalImage.style.display = "none";
	                modalCaption.textContent = this.src.split('/').pop();
	            }
	        });
	    }

	    // Close modal on click outside or Escape key
		window.addEventListener('click', function(event) {
	        if (event.target == modal || event.key === 'Escape') {
	            modal.style.display = "none";
	            if (!modalVideo.paused) {
		            modalVideo.pause();
		        }
	        }
	    });
	    window.addEventListener('keydown', function(event) {
		    if (event.key === 'Escape') {
		        modal.style.display = "none";
		        if (!modalVideo.paused) {
		            modalVideo.pause();
		        }
		    }
		});

	    // Change cursor on hover over images or videos based on SHIFT key
		document.addEventListener('mousemove', function(event) {
		    if (event.shiftKey) {
		        if (event.target.classList.contains('image') || event.target.classList.contains('video')) {
		            event.target.style.cursor = 'pointer';
		        }
		    } else {
		        if (event.target.classList.contains('image') || event.target.classList.contains('video')) {
		            event.target.style.cursor = 'default';
		        }
		    }
		});

		// Keyboard navigation for image scrolling
		function scrollToNextRow(direction) {
			var imagesPerRow = parseInt(document.getElementById('imageRange').value, 10);
			var firstImage = document.getElementsByClassName('image')[0];
			var rowHeight = firstImage.offsetHeight + parseInt(window.getComputedStyle(firstImage).marginBottom, 10);
			var currentPosition = window.pageYOffset || document.documentElement.scrollTop;
			var newRowPosition = direction === 'down' ? currentPosition + rowHeight + 15 : currentPosition - rowHeight - 15;
			window.scrollTo(0, newRowPosition);
		}

		// Keyboard shortcuts for selection actions
		document.addEventListener('keydown', function(e) {
			keysPressed[e.key] = true;
			if(keysPressed['Control'] || keysPressed['Meta']) {
				if(keysPressed['a']) {
					selectAllImages();
					e.preventDefault();
				}
			} else if(keysPressed['r'] && keysPressed['v']) {
				reverseSelections();
				e.preventDefault();
			} else if(keysPressed['d'] && keysPressed['l']) {
				if(Object.keys(keysPressed).length === 2 && keysPressed['d'] && keysPressed['l']) {
					downloadSelectedImages();
					e.preventDefault();
				}
			} else if(e.key === 'PageDown') {
				scrollToNextRow('down');
				e.preventDefault();
			} else if(e.key === 'PageUp') {
				scrollToNextRow('up');
				e.preventDefault();
			}
		});
		document.addEventListener('keyup', function(e) {
			delete keysPressed[e.key];
		});
		
		// Initial update of image layout
		updateImages();

		// Delayed check for broken images
		setTimeout(function() {
	        var images = document.getElementsByClassName('image');
	        for (var i = 0; i < images.length; i++) {
	            if (!images[i].complete || images[i].naturalWidth === 0) {
	                images[i].style.height = 'fit-content';
	                images[i].style.position = 'relative';
	                images[i].style.bottom = '4px';
	            }
	        }
	    }, 2000);

	};

</script></head>
<body>
	<div class="imagesContainer">
		<img class="image" src="1.jpg">
		<img class="image" src="2.jpg">
		<div class="video-container">
			<video class="video" src="3.mp4"></video>
			<div class="play-icon">&#9658;</div>
		</div>
	</div>
</body></html>
